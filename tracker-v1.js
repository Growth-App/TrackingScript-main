!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.onload=function(){io()},e.src="/socket.io/socket.io.js",document.getElementsByTagName("head")[0].appendChild(e)}();const referralSource=document.referrer;function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}const searchQuery=getParameterByName("q",referralSource),urlParams=new URLSearchParams(referralSource),searchEngine=urlParams.get("utm_source");let paidKeywords;"google"===searchEngine?(paidKeywords=urlParams.get("utm_term"),console.log("Paid Search Keywords:",paidKeywords)):console.log("Not a paid search referral.");const isDirectTraffic=""===referralSource||referralSource.startsWith(window.location.origin);isDirectTraffic?console.log("Direct Traffic"):console.log("Not Direct Traffic");const referrer=referralSource.toLowerCase();function getURLParameters(e){const t=e.split("?");if(1===t?.length)return{};const n=t[1],o={};return n.split("&").forEach((e=>{const[t,n]=e.split("=");o[t]=decodeURIComponent(n)})),o}referrer.includes("facebook.com")?console.log("from facebook"):referrer.includes("x.com")?console.log("from Twitter"):referrer.includes("instagram.com")?console.log("from Ig"):console.log("Not from social media source that is detectable");const currentURL=window.location.href,campaignParameters=getURLParameters(currentURL),utmSource=campaignParameters.utm_source,utmMedium=campaignParameters.utm_medium,utmCampaign=campaignParameters.utm_campaign,utmTerm=campaignParameters.utm_term,utmContent=campaignParameters.utm_content;console.log("UTM Source:",utmSource),console.log("UTM Medium:",utmMedium),console.log("UTM Campaign:",utmCampaign),console.log("UTM Term:",utmTerm),console.log("UTM Content:",utmContent);let timeSpentSeconds=0;function getCurrentTime(){return(new Date).getTime()}var startTime=getCurrentTime();function calculateTimeSpent(){var e=getCurrentTime();return timeSpentSeconds=Math.floor((e-startTime)/1e3),timeSpentSeconds}function logTimeSpent(){timeSpentSeconds=calculateTimeSpent()}window.addEventListener("beforeunload",(function(){logTimeSpent()}));let hasInteracted=!1;function trackInteraction(){hasInteracted=!0}function trackExit(){hasInteracted||console.log("a User bounced!")}document.addEventListener("DOMContentLoaded",(()=>{document.addEventListener("click",trackInteraction),window.addEventListener("beforeunload",trackExit)}));let navigationPaths=[];function trackNavigationPaths(){navigationPaths.push(window.location.href),console.log("Navigation path:",navigationPaths.join(" > "))}trackNavigationPaths();let scrollDepthPercentage=0;function trackScrollDepth(){const e=document.documentElement.scrollHeight-window.innerHeight,t=window.scrollY;scrollDepthPercentage=t/e*100,console.log("Scroll depth:",scrollDepthPercentage.toFixed(2)+"%")}window.addEventListener("scroll",trackScrollDepth);let deadClickCount=0,deadClicksArray=[];function trackDeadClicks(e){const t="a"===e.target.tagName.toLowerCase(),n=e.target.closest("[data-action]");if(!t&&!n){deadClickCount++;const t={target:e.target,timestamp:(new Date).toISOString()};deadClicksArray.push(t),console.log("Dead click detected:",e.target)}}document.body.addEventListener("click",trackDeadClicks);let lastScrollTop=0,scrollDirection="",scrollDistance=0;window.addEventListener("scroll",(function(){let e=window.window.scrollY||document.documentElement.scrollTop;scrollDirection=e>lastScrollTop?"down":"up",scrollDistance=Math.abs(e-lastScrollTop);scrollDistance>500&&console.log("Excessive scroll detected:",scrollDistance,"pixels","in",scrollDirection,"direction"),lastScrollTop=e}));const rageClickThreshold=5;let clickCount=0,lastClickTime=0,rageClicks=[];document.addEventListener("click",(function(e){const t=(new Date).getTime();t-lastClickTime<=1e3?clickCount++:(clickCount=1,rageClicks=[]),lastClickTime=t,clickCount>=5&&(rageClicks.push({target:e.target.tagName.toLowerCase(),time:(new Date).toISOString(),details:e.target.dataset}),console.log("Rage click detected on element:",e.target))}));let lastPageUnloadTime,error,quickbackClicks=[];function handleScriptError(e){error={message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,errorObject:e.error}}window.addEventListener("beforeunload",(function(e){lastPageUnloadTime=(new Date).getTime()})),window.addEventListener("DOMContentLoaded",(function(e){window.addEventListener("pageshow",(function(e){if((new Date).getTime()-lastPageUnloadTime<=1e3){const e={time:(new Date).toISOString(),url:window.location.href};quickbackClicks.push(e),console.log("Quickback click detected:",e)}}))})),window.addEventListener("error",handleScriptError),window.addEventListener("unhandledrejection",handleScriptError),window.addEventListener("DOMContentLoaded",(function(){window.addEventListener("load",(function(){setTimeout((function(){0===performance.getEntriesByType("resource").filter((function(e){return"script"===e.initiatorType&&e.name.includes("the_script_url")})).length&&handleScriptError({message:"Script failed to load",filename:"N/A",lineno:"N/A",colno:"N/A",error:"N/A"})}),3e3)}))}));let errorClicks=[];window.addEventListener("click",(function(e){window.addEventListener("error",(function(e){errorClicks.push({target:e.target,timestamp:(new Date).toISOString()})}))}));let sessionCount=localStorage.getItem("sessionCount");sessionCount=sessionCount?parseInt(sessionCount)+1:1,localStorage.setItem("sessionCount",sessionCount),console.log("Total Session Count:",sessionCount);let formDataArray=[];document.addEventListener("submit",(function(e){const t=e.target;if(t&&"FORM"===t.tagName){const e=new FormData(t),n={};for(const[t,o]of e.entries())n[t]=o;formDataArray.push(n)}}));let trackVideoEventData=function(e,t,n){return console.log(`Video ID: ${e}, Event: ${t}, Timestamp: ${n}`),{videoId:e,eventType:t,timestamp:n}};function attachVideoEventListeners(){document.querySelectorAll("video").forEach((e=>{e.addEventListener("play",(()=>{trackVideoEventEventData(e.id,"play",Date.now())})),e.addEventListener("pause",(()=>{trackVideoEventEventData(e.id,"pause",Date.now())})),e.addEventListener("ended",(()=>{trackVideoEventEventData(e.id,"ended",Date.now())})),e.addEventListener("timeupdate",(()=>{}))}))}document.addEventListener("DOMContentLoaded",(()=>{attachVideoEventListeners()}));const downloadEventData=[];function trackDownloadEvent(e){const t={fileName:e,timestamp:(new Date).toISOString()};downloadEventData.push(t)}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("a[data-download]").forEach((e=>{e.addEventListener("click",(t=>{trackDownloadEvent(e.getAttribute("data-download"))}))}))})),console.log(downloadEventData);const mouseMovement=function(e){const t=e.pageX,n=e.pageY;console.log(`Mouse moved to: (${t}, ${n})`)};document.addEventListener("mousemove",mouseMovement);const clickEvents=[];function trackClickOrTap(e){const t={targetElement:e.target.tagName,coordinates:{x:e.pageX,y:e.pageY}};clickEvents.push(t)}function logClickEvents(){console.log("All click/tap events:",clickEvents)}document.addEventListener("click",trackClickOrTap),document.addEventListener("touchstart",trackClickOrTap),logClickEvents();let lastInteractionTime=null,timeSinceLastInteraction=null;function trackInteractions(e){const t=Date.now();lastInteractionTime&&(timeSinceLastInteraction=t-lastInteractionTime,console.log(`Time since last interaction: ${timeSinceLastInteraction} ms`)),lastInteractionTime=t}function trackClick(e){const t=e.target,n=t.tagName.toLowerCase(),o=t.innerText||t.alt||t.src;console.log(`Clicked ${n}: ${o}`)}document.addEventListener("click",trackInteractions),document.addEventListener("click",trackClick);const hoveredElements=[];function trackMouseHover(e){const t={tagName:e.target.tagName,className:e.target.className,id:e.target.id};hoveredElements.push(t)}document.addEventListener("mouseover",trackMouseHover);let pageViewsData=[];function trackPageViews(){const e=window.location.pathname;let t=localStorage.getItem(e);t?(t=parseInt(t)+1,localStorage.setItem(e,t.toString())):localStorage.setItem(e,"1"),pageViewsData.push({page:e,views:localStorage.getItem(e)}),console.log(`Page ${e} viewed ${localStorage.getItem(e)} times.`)}trackPageViews();let timeToFirstByte=null;function trackTTFB(){if(window.performance&&window.PerformanceNavigationTiming){const e=window.PerformanceNavigationTiming;timeToFirstByte=e.responseStart-e.navigationStart,console.log(`Time to first byte: ${timeToFirstByte} milliseconds`)}else console.log("Navigation timing API is not supported.")}window.addEventListener("load",trackTTFB);let errMsg=null;window.onerror=function(e){e.includes("404")&&(errMsg=e)};const brokenLinks=[];function detectBrokenLinks(){document.querySelectorAll("a").forEach((e=>{const t=e.href;fetch(t).then((e=>{e.ok||e.status>=300&&e.status<400||brokenLinks.push({url:t})})).catch((e=>{brokenLinks.push({url:t,error:e.message})}))})),console.log("Broken links:",brokenLinks)}let trafficData={};function trackUserTraffic(){const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return trafficData.device_type=e?"Mobile":"Desktop",-1!==navigator.userAgent.indexOf("Firefox")?trafficData.browser_type="Firefox":-1!==navigator.userAgent.indexOf("SamsungBrowser")?trafficData.browser_type="Samsung Internet":-1!==navigator.userAgent.indexOf("Opera")||-1!==navigator.userAgent.indexOf("OPR")?trafficData.browser_type="Opera":-1!==navigator.userAgent.indexOf("Trident")?trafficData.browser_type="Internet Explorer":-1!==navigator.userAgent.indexOf("Edge")?trafficData.browser_type="Edge":-1!==navigator.userAgent.indexOf("Chrome")?trafficData.browser_type="Chrome":-1!==navigator.userAgent.indexOf("Safari")?trafficData.browser_type="Safari":trafficData.browser_type="Unknown",-1!==navigator.userAgent.indexOf("Win")?trafficData.operating_system="Windows":-1!==navigator.userAgent.indexOf("Mac")?trafficData.operating_system="MacOS":-1!==navigator.userAgent.indexOf("X11")?trafficData.operating_system="UNIX":-1!==navigator.userAgent.indexOf("Linux")?trafficData.operating_system="Linux":trafficData.operating_system="Unknown",{"device type":`${trafficData?.device_type}`,"browser type":`${trafficData?.browser_type}`,"operating system":`${trafficData?.operating_system}`}}function generateUniqueID(){return`uid-${(new Date).getTime()}-${Math.random().toString(36).substr(2,9)}`}function getUserBrowserID(){let e=localStorage.getItem("browserID");return e||(e=generateUniqueID(),localStorage.setItem("browserID",e)),e}trackUserTraffic();const browserID=getUserBrowserID(),scriptBody={project_id:GrowthApp_ProjectId,apikey:GrowthAPP_ApiKey,userSessionId:browserID,metrics:{data:[{category:"Traffic Sources",params:{"referral sources":`${referralSource}`,"organic search keywords":`${searchQuery}`,"paid search keywords":`${paidKeywords}`,"direct traffic":`${isDirectTraffic}`,"social media source":`${referrer}`,"campaign tracking parameters":`${utmSource}, ${utmMedium}, ${utmCampaign}, ${utmTerm}, ${utmContent}`}},{category:"User Demographics",params:{"device type":`${trafficData?.device_type}`,"browser type":`${trafficData?.browser_type}`,"operating system":`${trafficData?.operating_system}`,"geographic location":`${trafficData?.geographic_location}`}},{category:"User Behavior",params:{"time spent on the website":timeSpentSeconds,"bounce rate":hasInteracted,"exit rate":hasInteracted,"navigation path":navigationPaths,"scroll depth":scrollDepthPercentage,"dead clicks":deadClicksArray,"excessive scroll":`Excessive scroll detected:, ${scrollDistance}, pixels, in, ${scrollDirection}, direction`,"rage click":rageClicks,"quickback click":quickbackClicks,"script error":error,"error click":errorClicks,"form submissions":formDataArray,"video views":`Video ID: ${trackVideoEventData?.videoId}, Event: ${trackVideoEventData?.eventType}, Timestamp: ${trackVideoEventData?.timestamp}`,downloads:downloadEventData,"clicks and taps":clickEvents,"time between interactions":`${timeSinceLastInteraction}`,hover:hoveredElements,"page views":pageViewsData,"time to first byte":`${timeToFirstByte} milliseconds`,"404 error pages":`${errMsg}`,"broken links":brokenLinks}}]}};let isRunning=!1;const runScriptonLoad=async()=>{if(!isRunning){isRunning=!0;try{const e=await fetch("https://growthapp-backend-c991.onrender.com/api/data/track-traffic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(scriptBody)}),t=await e.json();console.log(t)}catch(e){console.error(e)}finally{isRunning=!1}}};setInterval(runScriptonLoad,3e3),window.addEventListener("beforeunload",(function(){sendBeaconData()})),window.addEventListener("load",(function(){runScriptonLoad()}));